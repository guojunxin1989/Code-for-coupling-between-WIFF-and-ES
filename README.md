# Code-for-coupling-between-WIFF-and-ES
This program package is used to study the effects of the coupling between wave-induced fluid flow (WIFF) and elastic scattering on the P-wave dispersion and attenuation, which is based on the new model proposed in the paper “Effects of coupling between wave-induced fluid flow and elastic scattering on P-wave dispersion and attenuation in rocks with aligned fractures”. The detailed descriptions of each program are as follows:
1.Coupling_WIFF_Scattering_vis_to_per.m studies the effects of b (the ratio of fluid viscosity to background permeability) on the coupling between WIFF and elastic scattering, which corresponds to Figure 3 in the paper. Note that the data files inQscafile1.mat and vscafile1.mat are the attenuation and dispersion results corresponding to the infinite value of b. As this case requires a lot of calculation time, we calculate it in advance and then store the results (inQscafile1.mat and vscafile1.mat) to compare with the other cases. 
2.Coupling_WIFF_Scattering_fra_length.m studies the effects of fracture length (or radius) on the coupling between WIFF and elastic scattering, which corresponds to Figure 4 in the paper. 
3.Coupling_WIFF_Scattering_fra_thickness.m studies the effects of fracture thickness on the coupling between WIFF and elastic scattering, which corresponds to Figure 5 in the paper. 
4.Coupling_WIFF_Scattering_fra_den.m studies the effects of fracture density on the coupling between WIFF and elastic scattering, which corresponds to Figure 6 in the paper.
5.Coupling_WIFF_Scattering_fluid_bulk_modulus.m studies the effects of fluid bulk modulus on the coupling between WIFF and elastic scattering, which corresponds to Figure 7 in the paper. 
6.Comparison_with_other_theories.m compares the newly proposed model with other theories, General_Eshelby_model.m and anisotropy_Gassmann.m are two sub-programs used. This corresponds to Figure 8 in the paper. 
7.WIFF_scattering_decoupling.m compares the rigorous solutions of the P-wave dispersion and attenuation with the linear superposition, which corresponds to Figures 9 and 10 in the paper. Note that the *.mat files are the dispersion and attenuation data caused by WIFF and elastic scattering respectively and also their linear superposition. These data are obtained through the approach introduced in Section 4.2 of the paper. By setting a large value of b in the program WIFF_scattering_decoupling.m, we can obtain the separate effects of WIFF (inQWIFFfile.mat, vWIFFfile.mat) and elastic scattering (inQscafile.mat, vscafile.mat). Then we can linearly superpose them for three values of b (inQfile1.mat, inQfile2.mat, inQfile3.mat; vafile1.mat, vafile2.mat, vafile3.mat). These linear superposition results are compared to the rigorous solutions using the program WIFF_scattering_decoupling.m.

Note that all the input parameters can be found in the programs and also in Table 1 of the paper. When studying the effects of a specific parameter, only the studied parameter is varied while the other parameters are kept constant (whose values are shown in Table 1). 
